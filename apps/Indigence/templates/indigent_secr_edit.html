{% extends "index.html" %}
{% load static %}
{% block main %}
<div id="document" class="col-12">
	<div id="template" class="m-auto" style="width: 21cm;padding: 2cm;border:1px solid black;">
		<div style="text-transform: uppercase;">
			<strong>REPUBLIQUE DU BURUNDI</strong><br/>
			<strong>MINISTERE DE L&rsquo;INTERIEUR </strong><br/>
			<strong>ET DE LA FORMATION PATRIOTIQUE </strong><br/>
			<strong>ET DEVELOPPEMENT LOCAL</strong><br/>
			<strong>MUNICIPALITE DE {{ indigent.zone.commune.province }}</strong><br/>
			<strong>COMMUNE URBAINE DE {{ indigent.zone.commune }}</strong><br/>
			<strong>ZONE DE {{ indigent.zone.name }}</strong><br/>
			<strong><u>BUREAU D’ETAT CIVIL</u></strong><br/><br><br> <br> 
		</div>  
		<p style="text-align: center;"><strong><u>ATTESTATION D’INDIGENCE №</u></strong><u>&deg;</u><strong><u>&hellip;&hellip;.&hellip;../2020</u></strong></p>
		<p>
			Je soussigné, {{ indigent.zone.commune.leaderFullName }}, Administrateur de la Commune {{indigent.zone.commune}}, atteste par la présente que
			 {% if indigent.user.gender == Homme %}
				le nommé
			{% else %}
				la nommée  
			{% endif %}
			 {{ indigent.user.first_name }} {{ indigent.user.last_name }}, 

			{% if indigent.user.gender == Homme %}
			fils
			{% else %}
			fille
			{% endif %} 

			de  {{indigent.user.profile.father}}  et de {{indigent.user.profile.mother}}, originaire de la Colline {{indigent.user.profile.quarter}}, Commune {{indigent.user.profile.quarter.zone.commune}}, Province {{indigent.user.profile.quarter.zone.commune.province}}, résidant actuellement dans la Municipalité de {{indigent.zone.commune.province}} à l’adresse ci-après : {{indigent.zone.name}}, Q. {{indigent.residence_quarter}}, est 
			{% if indigent.user.gender == Homme %}
				INDIGENT
			{% else %}
				INDIGENTE
			{% endif %}.<br>.
                                           

		</p>

		<p>La pr&eacute;sente attestation lui est d&eacute;livr&eacute;e pour faire valoir ce que de droit.</p>
		<p>	<br><br>
			<strong><u>Sous couvert : </u></strong>
			<ul>
				{{indigent.sous_couvert}}
			</ul><br>

			<strong><u>Chef de Quartier {{indigent.residence_quarter}}</u></strong><br>
			<ul>
				{{indigent.residence_quarter.leaderFullName}}
			</ul><br>
					
			<strong><u>Approuvée par le Chef de Zone {{indigent.zone.name}}</u></strong><br>
			<ul>
				{{indigent.zone.leaderFullName}}
			</ul>

		</p>
		<p>&nbsp;</p>
				<p>&nbsp;</p>
		<table style="width: 600px; text-transform: uppercase;">
		<tbody>
		<tr>
		<td style="width: 315px;">&nbsp;</td>
		<td style="width: 275px;">
		<p style="text-align: center;"><strong>Fait &agrave; Bujumbura, le {{ today.today }}</strong></p>
		<p style="text-align: center;"><strong> L’ADMINISTRATEUR DE LA COMMUNE {{ indigent.zone.commune.name}}</strong></p>
		<p style="text-align: center;"><strong>{{ indigent.zone.commune.leaderFullName }}</strong></p>
		</td>
		</tr>
		</tbody>
		</table>
		<p style="text-align: right;">&nbsp;</p>
	</div>
</div>

<div style="position: fixed; right: 0px; top:40%">
  <div style="position: relative; top: -50%;" class="btn-group-vertical btn-group-lg float-right align-middle" role="group">
	<button type="button" class="btn btn-secondary" data-container="body" data-toggle="popover"  data-html="true" data-placement="left" data-content="<img src='{{ indigent.user.profile.cni_recto.url }}' height='300' />">
	  CNI Recto
	</button>
	<button type="button" class="btn btn-secondary" data-container="body" data-toggle="popover"  data-html="true" data-placement="left" data-content="<img src='{{ indigent.user.profile.cni_verso.url }}' height='300' />">
	  CNI verso
	</button>
	<button type="button" class="btn btn-secondary" data-container="body" data-toggle="popover"  data-html="true" data-placement="left" data-content="<b>{{ indigent.payment_method }} : <i>{{ indigent.payment_serial }}</i></b>">
	  Payements
	</button>
	<button type="button" class="btn btn-secondary" data-container="body" data-toggle="popover"  data-html="true" data-placement="left" data-content="Vivamus sagittis lacus vel augue laoreet rutrum faucibus.">
	  Other
	</button>
  </div>
</div>
<div class="m-2">
	<form action="./{{ document_id }}" method="post" enctype="multipart/form-data" class="new-added-form">
		{% csrf_token %}
		<input type="text" name="rejection_msg" value="" placeholder="rejection reason" class="form-control mb-2 rejection-msg" style="display:none;">
		<input type="submit" class="btn btn-outline-secondary" name="cancel" value="cancel">
		<input type="submit" class="btn btn-outline-success" name="validate" value="validate">
		<input type="submit" class="btn btn-outline-danger" id="rejection-button" name="reject" value="reject">
		<input type="submit" class="btn btn-outline-primary" id="print-button" name="print" value="print">
	</form>
</div>
<script type="text/javascript">
$(document).ready(function () {

$(function () {
  $('[data-toggle="popover"]').popover()
})
$("#rejection-button").on('click', function(event) {
	$rejection_msg = $(".rejection-msg");
	if($rejection_msg.css('display')=="none"){
		$rejection_msg.css('display',"");
		event.preventDefault();
	}else{
		if($rejection_msg.val().trim().length>0){

		}else{
			$rejection_msg.css('display',"none");
			event.preventDefault();
		}
	}
});
$("#print-button").on('click', function(event) {
	event.preventDefault();
	printDiv();
});

function printDiv() { 
	var divContents = document.getElementById("template").innerHTML; 
	var a = window.open('', '', 'height=500, width=1000'); 
	a.document.write('<html>'); 
	a.document.write('<body>'); 
	a.document.write(divContents); 
	a.document.write('</body></html>'); 
	a.document.close(); 
	a.print(); 
	a.close();
}

});
</script>
{% endblock main %}